supported_targets = "*"

##
## Runtimes
##

[runtime.example-rust.dependencies]
avocado-img-bootfiles = "*"
avocado-img-rootfs = "*"
avocado-img-initramfs = "*"
avocado-ext-dev = { ext = "avocado-ext-dev", vsn = "*" }
config-ext = { ext = "config" }
example-rust-ext = { ext = "example-rust" }

# BSPs
[runtime.example-rust.reterminal-dm.dependencies]
avocado-bsp-reterminal-dm = { ext = "avocado-bsp-reterminal-dm", vsn = "*" }

[runtime.example-rust.reterminal.dependencies]
avocado-bsp-reterminal = { ext = "avocado-bsp-reterminal", vsn = "*" }

[runtime.example-rust.raspberrypi5.dependencies]
avocado-bsp-raspberrypi5 = { ext = "avocado-bsp-raspberrypi5", vsn = "*" }

[runtime.example-rust.raspberrypi4.dependencies]
avocado-bsp-raspberrypi4 = { ext = "avocado-bsp-raspberrypi4", vsn = "*" }


##
## Extensions
##

[ext.config]
types = ["confext"]

[ext.config.users.root]
password = ""

[ext.example-rust]
types = ["sysext", "confext"]

[ext.example-rust.dependencies]
example-rust-app = { compile = "example-rust-app", install = "example-rust-install.sh" }

[ext.example-rust.sdk.dependencies]
nativesdk-rust = "*"
rust-cross-canadian-aarch64 = "*"
nativesdk-cargo = "*"
nativesdk-binutils = "*"
nativesdk-gcc = "*"
nativesdk-glibc-dev = "*"
nativesdk-libgcc-dev = "*"

##
## SDK
##

[sdk]
image = "avocadolinux/sdk:apollo-edge"
container_args = ["--network=avocado-dev-network"]
repo_url = "http://avocado-dev-repo"

[sdk.qemux86-64]
container_args = ["--network=host"]

[sdk.qemuarm64]
container_args = ["--network=host"]

[sdk.compile.example-rust-app]
compile = "rust-compile.sh"

##
## Provisioning
##

[provision.usb]
container_args = ["-v", "/dev:/dev", "-v", "/sys:/sys:ro", "--privileged"]

[provision.sd]
container_args = ["-v", "/dev:/dev", "-v", "/sys:/sys:ro", "--privileged"]
